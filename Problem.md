# Steiner Space Travel

実行時間制限は **1秒** となっております。ご注意ください。

## ストーリー

天体観測技術の進歩により、未知の惑星が多数発見された。そこで新たに開発された無人探査船を用いて、これらの惑星を全て調査することとなった。惑星間の移動には距離の2乗に比例したエネルギーを消費する。中継点となる宇宙ステーションを適切な場所に配置し、できるだけエネルギー消費量の少ない調査計画を立ててほしい。

## 問題文

惑星の座標がN個与えられる。各惑星は二次元平面上に存在し、i番目の惑星の座標は(a_i, b_i)である。また宇宙ステーションがM個あり、j番目の宇宙ステーションは0≦c_j≦1000, 0≦d_j≦1000を満たす任意の整数座標(c_j, d_j)に配置することができる。一度配置した宇宙ステーションを再度別の座標に配置し直すことはできない。

惑星と宇宙ステーションを合わせて「経由地」と呼称し、訪問する経由地の数をV、k番目に訪問する経由地の座標を(x_k, y_k)とおく。k番目の経由地からk+1番目の経由地に移動する際に消費するエネルギーE_k（1≦k≦V-1）を、両者間のユークリッド距離d_k=√((x_k - x_k+1)^2+(y_k - y_k+1))^2および定数αを用いて以下のように定義する。

- k番目の経由地とk+1番目の経由地がともに惑星の場合: E_k=α^2 d_k^2
- k番目の経由地とk+1番目の経由地のいずれか一方のみが惑星の場合: E_k=α d_k^2
- k番目の経由地とk+1番目の経由地がともに宇宙ステーションの場合: E_k=d_k^2

いずれも消費エネルギーが **ユークリッド距離の2乗に比例** することに注意せよ。

各宇宙ステーションを配置した上で、惑星1から出発して全ての惑星を1回以上訪問し再度惑星1に戻ってくる経路であって、消費エネルギーの総和ΣE_kができるだけ小さいものを求めよ。同じ経由地を何度訪問してもよく、訪問しない宇宙ステーションが存在しても構わない。また配置した宇宙ステーションの座標が他の経由地と一致していてもよい。

## 得点

消費エネルギーの総和がS(=ΣE_k)であるとき、round(10^9/(1000+√S))点が得られる。ただし、出力が不正である場合は`WA`と判定される。不正な出力とは以下を指す。

- 出力のフォーマットが正しくない出力
- 変数の値が制約を満たさない出力
- 始点が惑星1でない出力
- 終点が惑星1でない出力
- 未訪問の惑星が存在する出力

テストケースは全部で50個あり、全テストケースの得点の合計が提出の得点となる。コンテスト時間中に得た最高得点で最終順位が決定され、コンテスト終了後のシステムテストは行われない。

## 入力

全てのテストケースにおいて、α=5で固定である。

入力は以下の形式で標準入力から与えられる。

```text
N M
a_1 b_1
...
a_N b_N
```

各変数は以下の制約を満たす。

- N = 100
- M = 8
- 0≦a_i≦1000
- 0≦b_i≦1000
- i≠i' ならば (a_i, b_i)≠(a_i', b_i')
- 入力は全て整数

## 出力

以下のフォーマットで標準出力に出力し、最後に改行せよ。

```text
c_1 d_1
...
c_M d_M
V
t_1 r_1
...
t_V r_V
```

ここでt_kはk番目の経由地の種類を表す整数であり、惑星の場合は`1`、宇宙ステーションの場合は`2`である。またr_kはk番目の経由地の番号であり、惑星の場合は1≦r_k≦N、宇宙ステーションの場合は1≦r_k≦Mである。各変数は以下の制約を満たさなければならない。

- 0≦c_j≦1000
- 0≦d_j≦1000
- 1≦V≦10^5
- t_k∈{ 1, 2 }
- 1≦r_k≦N (t_k=1のとき), 1≦r_k≦M (t_k=2のとき)
- t_1 = t_V = 1
- r_1 = r_V = 1
- 出力は全て整数

## 入力生成方法

この項目は問題文の理解に必須ではない。

以下の手順で入力を生成する。なお、L以上U以下の整数値を一様ランダムに生成する関数をrand(L, U)で表す。

1. l=1, 2, ..., 15について、以下の手順で基準点(u_l, v_l)を生成する。
   1. u_l=rand(100, 900), v_l=rand(100, 900)とする。ただし、既に生成した基準点のうち、(u_l, v_l)とのユークリッド距離が100以下であるものが存在した場合は再度u_l, v_lの生成をやり直す。
1. i=1, 2, ..., 100について、以下の手順でi番目の惑星の座標(x_i, y_i)を生成する。
   1. m_i=rand(1, 15)を生成する。
   1. dx_i=rand(-100, 100), dy_i=rand(-100, 100)として、x_i=u_m_i+dx_i, y_i=v_m_i+dy_iとする。ただし、(x_i, y_i)が既に生成された惑星の座標と一致する場合は再度m_i, dx_i, dy_iの生成をやり直す。

## ツール（入力ジェネレータ・ビジュアライザ）

- Web版
- ローカル版: 使用するには[.NET 6 Runtime](https://dotnet.microsoft.com/ja-jp/download)が必要です。同梱の`README.md`を参照ください。
